### 主题方案和基础组件：如何设计组件库的主题方案？

#### 组件库的主题方案设计需要做什么准备？

既然是方案设计，首先要做的是方案的规范准备，这里主题的方案设计需要准备以下两种规范：

- 颜色的设计规范；
  首先要明确一点，颜色规范设计通常不是前端开发者的职责工作，而是设计师的工作。<br/>

  1. 第一步是颜色种类的选择。一般设计师会选择几种大类型的颜色，例如红色、蓝色和绿色等。然后根据业务需要挑选这几类型中的一个基准色号。
  2. 第二步，基于上一步选择好的基准色号，进行颜色梯度的处理，例如颜色亮度和饱和度从浅到深的梯度处理。举个例子，灰色的颜色梯度处理如下图片所示：
     ![](https://static001.geekbang.org/resource/image/dc/75/dc831de00fc4eea40170e64c7a978675.png?wh=1718x352)
  3. 最后一步，也就是第三步，根据不同颜色的颜色梯度，进行语义化使用处理。我们拿上述灰色每个梯度的颜色来“语义化处理”，将“灰色 1 号”作为页面背景颜色，“灰色 10 号”作为页面的字体颜色。效果如下述所示：
     ![](https://static001.geekbang.org/resource/image/25/6c/25f3bd28dc6ec37ed320c240d9e46a6c.png?wh=1720x318)<br/>

  <b>如果只是前端程序员自发建设组件库，没有设计师参与设计，要如何做颜色的设计规范呢？</b>
  这类无设计师的情况你也不用担心，有很多开源组件库都提供了现成的颜色设计规范。例如 Ant Design 官方团队的颜色规范、Element Plus 官方团队的颜色规范都可以直接参考。

- CSS 的开发规范。

      首先，我们要选择 CSS 的预处理器语言来开发，主要利用 CSS 预处理器语言的“可编程的逻辑语法”来编写 CSS。目前主流的 CSS 的预处理器语言有 Less 和 Sass，两者语法比较类似。
      * Less，对 CSS 原始语法增加了少许方便的扩展，例如函数、运算等语法，学习更容易
      * 预处理器 Sass，语法更加丰富和全面。

  <br/>
  我们可以用 Less 里的变量语法来管理所有的颜色梯度，如下述代码所示：

  ```
  @gray-1: #f5f5f5;
  @gray-2: #f0f0f0;
  @gray-3: #d9d9d9;
  @gray-4: #bfbfbf;
  @gray-5: #8c8c8c;
  @gray-6: #595959;
  @gray-7: #434343;
  @gray-8: #262626;
  @gray-9: #1f1f1f;
  @gray-10: #141414;
  ```

接下来我们还要管理具体组件的主题样式上面，而且还要语义化控制到具体某个组件的某个维度的颜色。
使用<b>CSS Variable </b>来管理语义化的组件颜色

```

@prefix-name: my-vue;

@white: #ffffff;
@black: #222222;
// ...
@gray-4: #bfbfbf;
// ...

:root {
  // 页面背景颜色
  --@{prefix-name}-page-bg-color: @white;
  // 页面字体颜色
  --@{prefix-name}-page-text-color: @black;
  // 页面通用边框颜色
  --@{prefix-name}-page-border-color: @gray-4;
}

.@{prefix-name}-box {
  background: ~'var(--@{prefix-name}-page-bg-color)';
  color: ~'var(--@{prefix-name}-page-text-color)';
}
```

这里的代码是用 Less 来管理颜色梯度，再用 CSS Variable 来使用颜色梯度的 Less 变量，同时语义化来管理不同维度的语义化颜色。CSS Variable 更多的用法可以参考这个[官方文档](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties)。

#### 如何实现组件库主题方案？

效果：
![](https://static001.geekbang.org/resource/image/68/72/685ae92141680743d9c98c868db29372.gif?wh=599x260)
在这张动图中，我实现了一个组件 Box，设置了组件语义化的背景色和字体色，切换主题的时候，就用 className 的优先级来控制语义化的 CSS Variable，也就是用新主题的颜色样式覆盖掉原有的默认主题的颜色样式，达到动态切换主题。
<br/>
组件库的主题方案设计核心就是<b>颜色规范 + CSS Variable 控制</b>。

#### 如何开发一个多状态的按钮组件？

效果：
![](https://static001.geekbang.org/resource/image/ba/10/bayy5ee855313c057e0b37c029335e10.gif?wh=600x200)
上面动图中，演示的是常见组件库里实现的按钮组件，具备多种组件的状态维度，这里维度分成按钮类型、按钮变种（种类）和按钮禁用状态。其中按钮类型有 Default、Primary，Success、Warn 和 Danger 这五类，按钮变种有 Contented 和 Outlined 两类，按钮禁用状态有 Enabled 和 Disabled 两类。
<br/>

总的来讲，上述按钮有这三种维度状态，也就是类型、变种和是否禁用。那么，如何实现这个三种维度的叠加管理呢？分解成这三个步骤：

- 第一步，基础按钮组件样式的开发；
- 第二步，实现按钮不同维度组合的样式；
- 第三步，组件的使用状态叠加。

第一步，基础按钮组件的样式开发，也就是实现一个按钮的“底座”，后续可以基于这个底座做各类维度叠加的样式开发.
./packages/components/theme/variable.less
./packages/components/theme/index.ts

第二步，实现按钮不同维度组合的样式，也就是我们要根据不同状态维度的组合来实现样式的叠加。

第三步，就是实现按钮其他状态叠加，例如鼠标悬浮时候（Hover）等状态，也是添加对应的 CSS Variable，然后在 Less 里使用对应变量。

#### 如何对多状态的按钮组件进行主题控制？

<b>主题核心就是颜色梯度的控制</b>
<br/>
具体拆解成两步：<br>

- 第一步，对按钮不同状态维度组合选择对应色板的颜色梯度；
- 第二步，将选好的颜色用新 className 来覆盖原来的 CSS Variable。
  效果：
  ![](https://static001.geekbang.org/resource/image/ba/10/bayy5ee855313c057e0b37c029335e10.gif?wh=600x200)

> 此文章为 3 月 Day10 学习笔记，内容来源于极客时间《Vue 3 企业级项目实战课》，学习使我快乐，每天进步一点点 💪💪
