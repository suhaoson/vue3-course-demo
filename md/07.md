### 项目代码规范：如何成为一名合格的团队协作工程师？

#### Vue 3 项目代码规范有哪些方面？

1. 强类型语言开发 JavaScript；
2. 代码格式规范；
3. 代码质量检查。

4. 我们先来看第一点，用强类型语言开发 JavaScript。一般用强类型的语言开发 JavaScript 应用，即使用 TypeScript 进行开发。TypeScript 的显式类型，可以减少 JavaScript 语言因为弱类型原因带来的潜在问题，例如常见的浏览器运行时，对象属性不存在的问题。
5. 第二点就是代码格式规范。一般是在开发过程中，我们都会用工具来统一代码风格，方便代码的阅读，更方便团队的开发合作。
6. 最后一点，代码质量检查。也就是检查代码质量，在开发过程中减少代码中潜在的问题。这个是最重要的，如果代码质量规范限制严格，可以大大减少线上问题。

#### 如何在 Vue3 项目中快速使用 TypeScript？

我们现在举一个例子对比说明一下。这是存在属性访问问题的 JavaScript 代码：

```
const obj = {
  a: null
};
console.log(obj.a.b + 1);
```

![](https://static001.geekbang.org/resource/image/12/b2/1274c4e777a1eba71f3bdef4e77b73b2.png?wh=320x480)
<br/>

```
// 用 type 定义数据类型 MyObject
type MyObject = {
  a: null;
};

// 用类型 MyObject 来声明变量 obj
const obj: MyObject = {
  a: null
};

console.log(obj.a.b + 1);
```

这段代码是将前面存在问题的 JavaScript 代码改造成了 TypeScript 代码，我们只是加上了 TypeScript 类型定义和变量类型声明，在开发阶段就能基于 VS Code 编辑器发现错误了，如下图所示：
![](https://static001.geekbang.org/resource/image/e6/03/e60d805dc0337c2c80f74bcc0381d903.png?wh=768x375)
在 TypeScript 代码编译成 JavaScript 代码过程中，也会报错，如下图所示：
![](https://static001.geekbang.org/resource/image/f1/d9/f1da8ae9a43b615310ee5e2021be0ed9.png?wh=768x280)

```
不过这里有一个注意点，就是浏览器里并不能直接运行 TypeScript 代码，TypeScript 代码最终还是需要编译成 JavaScript 代码才能在浏览器中运行。所以，TypeScript 的作用主要是在开发阶段和编译阶段辅助开发者排除掉代码的类型隐患，而不是避免隐患。
```

如果我们要把上节课的项目改造成 TypeScript 项目，需要做以下的 TypeScript 项目配置四个步骤。<br/>

1. 第一步：安装 Vue 3 TypeScript 项目需要用到的 npm 模块依赖：
   - 执行安装依赖命令：npm i -D typescript @vue/tsconfig；
   - 其中 typescript 模块是 TypeScript 官方的编译模块，@vue/tsconfig 是 Vue 3 官方的配置模块，我们可以基于这个模块来直接使用官方的推荐配置，减少初始化配置的成本。
2. 第二步：配置 TypeScript 的配置文件 tsconfig.config.json：
3. 第三步：修改源码文件的 TypeScript 文件类型：
   - Vue 模板文件设置 TypeScript 语言类型 lang=“ts”；
   - JS 文件改成 TS 文件。
4. 第四步：给项目源码文件的数据添加 TypeScript 类型声明。

   - 先在项目根目录创建一个给 Vue 文件的类型声明文件 env.d.ts：

   ```
   /// <reference types="vite/client" />
   ```

   - 再创建一个类型的文件 src/types.ts，主要给项目业务逻辑需要用到的数据进行类型声明，具体内容如下代码所示：
   - 接下来，我们就可以将这个项目的数据类型给所有 TypeScript 代码引用了。

#### 如何在 VS Code 用 ESLint 和 Prettier 规范代码格式？

如果你想高效率地开发 Vue 3 项目，我建议你用 VS Code 这个开源免费的代码编辑器进行开发。我们这门课所有项目都是基于 VS Code 编辑器来进行开发的，所有项目规范配置也是基于 VS Code 代码编辑器。<br/>
使用 VS Code 结合 ESLint 和 Prettier<br/>
那如何实现上述说的代码文件保存时自动格式化代码呢？我们需要对 ESLint、Prettier 和 VS Code 进行相应的配置。

1. 我们先来看第一步，ESLint 配置，ESLint 功能是代码格式化和代码质量检查。
2. 第二步，是 Prettier 配置。Prettier 的作用是格式化代码风格，后续加上 VS Code 的 Prettier 插件，可以在保存代码时候，自动格式化代码风格。
3. 第三步，就是 VS Code 编辑器的配置，主要是能和 ESLint 和 Prettier 配置进行联动生效。<br/>
   我们先要安装 VS Code 的 ESLint 和 Prettier 等相关插件。这里 Vue 3 项目需要以下五个 VS Code 插件：<br>

- Vue.volar ： Vue 3 官方推荐的 VS Code 开发插件；
- Vue.vscode-typescript-vue-plugin： Vue 3 TypeScript 语法辅助 VS Code 插件；
- dbaeumer.vscode-eslint ： ESLint 的 VS Code 插件；
- esbenp.prettier-vscode ：Prettier 的 VS Code 插件；
- rvest.vs-code-prettier-eslint：ESLint 联动 Prettier 的 VS Code 插件；

#### 如何用 ESLint 检查代码质量？

- 首先需要在 package.json 里配置 ESLint 的 CLI 使用脚本：
- 然后就可以在项目根目录的命令框里执行 npm run lint 进行代码风格和质量的统一检查，以及部分问题的修复，所有的代码风格规范和质量规范都是统一使用根目录下的 .eslintrc.cjs 的配置文件里的规范内容。
  <br/>
  如果出现代码质量问题会报错，如下图所示：
  ![](https://static001.geekbang.org/resource/image/18/7d/18f8f0a4217ddf04f8c9c581f0f2677d.png?wh=1920x562)

> 此文章为 3 月 Day8 学习笔记，内容来源于极客时间《Vue 3 企业级项目实战课》，学习使我快乐，每天进步一点点 💪💪
